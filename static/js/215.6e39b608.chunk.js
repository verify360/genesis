"use strict";(self.webpackChunkverify360_react=self.webpackChunkverify360_react||[]).push([[215],{4215:(e,l,t)=>{t.r(l),t.d(l,{default:()=>L});var a=t(42419),n=t(41286),i=t(85246),r=t(13967),o=t(95193),d=t(25801),s=t(97639),c=t(13239),u=t(64554),h=t(30439),m=t(20792),p=t(89891),x=t(94515),v=t(96846),f=t(61731),y=t(74599),_=t(763),g=t(72791),j=t(57689),C=t(25180),Z=(t(16579),t(3058)),b=t(94721),S=t(4567),D=t(66770),k=t.n(D),w=(t(86009),t(81694)),N=t.n(w),A=t(80184);const E=e=>{const{value:l,onChange:t,className:a,wrapperClass:n,placeholder:i}=e;return(0,A.jsx)("div",{className:N()("react-text-formatter w-full h-full",n),children:(0,A.jsx)(k(),{theme:"snow",placeholder:i,value:l,onChange:t,modules:{toolbar:{container:[["bold","italic","underline","strike","link","blockquote"],[{size:["small",!1,"large","huge"]},{color:[]}],[{list:"ordered"},{list:"bullet"},{align:[]}]]},clipboard:{matchVisual:!1}},formats:["bold","italic","underline","strike","link","blockquote","size","color","list","bullet","align"],className:N()("react-quill",a)})})};var I=t(75985);const T=e=>{let{id:l,handleClose:t}=e;const[a,n]=(0,g.useState)({uploadedFileData:"",textInputData:""}),[i,r]=(0,g.useState)([]);(0,g.useEffect)((()=>{try{y.Z.ListClients().then((e=>{let l=JSON.parse(e.data.data);r(l)}))}catch(e){console.error(e)}}),[]),(0,g.useEffect)((()=>{var e;const t=(0,_.find)(i,(e=>(null===e||void 0===e?void 0:e.id)===l)),r=null!==t&&void 0!==t&&null!==(e=t.candidateAuthForm)&&void 0!==e&&e.startsWith("file:")?{...a,uploadedFileData:null===t||void 0===t?void 0:t.candidateAuthForm.substring(5).trim()}:{...a,textInputData:null===t||void 0===t?void 0:t.candidateAuthForm};n(r)}),[i]);return(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,A.jsx)("div",{style:{display:"flex",paddingBottom:"1rem"},children:(0,A.jsx)("h2",{children:"Report"})}),(0,A.jsxs)("div",{style:{padding:"5px",border:"1px solid silver",width:"100%",borderRadius:"5px",cursor:"pointer",display:"flex"},children:[(0,A.jsx)("input",{type:"file",id:"fileInput",accept:".pdf",style:{display:"none"},onChange:e=>(e=>{try{y.Z.handleFileUpload(e).then((e=>{var l;200===(null===e||void 0===e?void 0:e.status)&&n({...a,uploadedFileData:null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.filename})}))}catch(e){console.error("error ocuured:",e)}})(e)}),(0,A.jsx)("button",{onClick:()=>document.getElementById("fileInput").click(),children:"Choose file"}),(null===a||void 0===a?void 0:a.uploadedFileData)&&(0,A.jsxs)("div",{style:{display:"flex",paddingLeft:"0.6rem",paddingTop:"0.2rem"},children:[(0,A.jsx)("span",{children:null===a||void 0===a?void 0:a.uploadedFileData}),(0,A.jsxs)("span",{onClick:()=>{n({...a,uploadedFileData:""})},children:[" ",(0,A.jsx)(Z.Z,{sx:{fontSize:"1.25rem",paddingTop:"0.1rem"}})]})]})]}),(0,A.jsxs)(u.Z,{display:"flex",alignItems:"center",textAlign:"center",marginY:2,children:[(0,A.jsx)(b.Z,{flexItem:!0,style:{flexGrow:1}}),(0,A.jsx)(S.Z,{variant:"body1",color:"textSecondary",sx:{marginX:2},children:"OR"}),(0,A.jsx)(b.Z,{flexItem:!0,style:{flexGrow:1}})]}),(0,A.jsx)(E,{placeholder:"Enter your text here",onChange:e=>n({...a,textInputData:"<p><br></p>"!==e?e:""}),value:null===a||void 0===a?void 0:a.textInputData})]}),(0,A.jsxs)("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[(0,A.jsx)(h.Z,{color:"primary",variant:"contained",onClick:()=>t(),children:"Cancel"}),(0,A.jsx)(h.Z,{type:"submit",color:"primary",variant:"contained",onClick:()=>{if((0,_.isEmpty)(null===a||void 0===a?void 0:a.uploadedFileData)||(0,_.isEmpty)(null===a||void 0===a?void 0:a.textInputData)){let n={table_name:"clients",field_to_update:"candidateAuthForm",new_value:(0,_.isEmpty)(null===a||void 0===a?void 0:a.textInputData)?"file: ".concat(null===a||void 0===a?void 0:a.uploadedFileData):null===a||void 0===a?void 0:a.textInputData,table_id:l};try{y.Z.UpdateData(n).then((e=>{200===(null===e||void 0===e?void 0:e.status)&&((0,C.OD)("Client report updated successfully"),t())}))}catch(e){console.error("Error updating record :",e)}}else I.Am.info("Please select either the option to upload a file or utilize the text input feature.")},disabled:(0,_.isEmpty)(null===a||void 0===a?void 0:a.uploadedFileData)&&(0,_.isEmpty)(null===a||void 0===a?void 0:a.textInputData),children:"Submit"})]})]})};var F=t(81153),q=t(93006),R=t(45363),P=t(50168),O=t(17563),W=t(82626),B=t(92506),G=t(81724);const z=G.Ry().shape({client_name:G.Z_().required("Required"),contact_name:G.Z_().required("Required"),email:G.Z_().required("Required"),phone:G.Z_().required("Required"),fin_contact_name:G.Z_().required("Required"),fin_email:G.Z_().required("Required"),fin_phone:G.Z_().required("Required"),address:G.Z_().required("Required"),country:G.Z_().required("Required")}),J=e=>{let{id:l,clients:t,handleClose:a,fetchData:n}=e;const[i,r]=(0,g.useState)(""),o=t;const s={width:"300px",marginBottom:"15px"},c=t.filter((e=>e.id===l))[0],m=(0,B.TA)({initialValues:c||{client_name:"",contact_name:"",client_type:"",email:"",phone:"",parent_client:0,fin_contact_name:"",fin_email:"",fin_phone:"",address:"",country:"",active:!1,approveToClose:!1},validationSchema:z,onSubmit:e=>{alert(JSON.stringify(e,null,2));o.map((l=>l.id===e.id?e:l));e.parent_client=null===e.parent_client||""==e.parent_client?0:e.parent_client,function(e){try{let l=y.Z.mClient({data:e});if(l.then((e=>{200===(null===e||void 0===e?void 0:e.status)&&((0,C.OD)("Client updated succesfully"),n(),a())})),l.data&&!1===l.data.success)return r(l.data.msg)}catch(l){return l.response?r(l.response.data.msg):r("There has been an error.")}}(e),a()}});return t=t.filter((e=>e.id!==l)),(0,A.jsx)(B.Hy,{value:m,children:(0,A.jsxs)("form",{onSubmit:m.handleSubmit,children:[(0,A.jsxs)(F.ZP,{container:!0,spacing:3,children:[(0,A.jsxs)(F.ZP,{item:!0,sm:6,children:[(0,A.jsx)("h2",{children:"Manage Client"}),(0,A.jsx)(S.Z,{variant:"h6",children:"General Information"}),(0,A.jsx)("p",{}),(0,A.jsx)(B.gN,{as:q.Z,style:{...s},name:"client_name",label:"Client Name",fullWidth:!0,onChange:e=>{var l;return null===m||void 0===m?void 0:m.setFieldValue("client_name",(0,C.Ao)(null===e||void 0===e||null===(l=e.target)||void 0===l?void 0:l.value))},value:m.values.client_name||"",error:m.touched.client_name&&Boolean(m.errors.client_name),helperText:m.touched.client_name&&m.errors.client_name}),(0,A.jsx)(B.gN,{as:q.Z,style:{...s},name:"contact_name",label:"Contact Name",fullWidth:!0,onChange:e=>{var l;return null===m||void 0===m?void 0:m.setFieldValue("contact_name",(0,C.Ao)(null===e||void 0===e||null===(l=e.target)||void 0===l?void 0:l.value))},value:m.values.contact_name||"",error:m.touched.contact_name&&Boolean(m.errors.contact_name),helperText:m.touched.contact_name&&m.errors.contact_name}),(0,A.jsx)(B.gN,{as:q.Z,style:{...s},name:"email",label:"Email",fullWidth:!0,onChange:m.handleChange,value:m.values.email,error:m.touched.email&&Boolean(m.errors.email),helperText:m.touched.email&&m.errors.email}),(0,A.jsx)(B.gN,{as:q.Z,style:{...s},name:"phone",label:"Phone",fullWidth:!0,onChange:m.handleChange,value:m.values.phone,error:m.touched.phone&&Boolean(m.errors.phone),helperText:m.touched.phone&&m.errors.phone}),(0,A.jsx)(B.gN,{as:q.Z,style:{...s},name:"address",label:"Address",fullWidth:!0,onChange:m.handleChange,value:m.values.address,error:m.touched.address&&Boolean(m.errors.address),helperText:m.touched.address&&m.errors.address}),(0,A.jsxs)(R.Z,{fullWidth:!0,children:[(0,A.jsx)(P.Z,{id:"select-label",children:"Select Country"}),(0,A.jsx)(O.Z,{id:"country",name:"country",style:{...s},fontSize:"sm",fullWidth:!0,label:"Country",width:"250px",variant:"outlined",onChange:m.handleChange,value:m.values.country||"",error:m.touched.country&&Boolean(m.errors.country),children:C.Jm.map(((e,l)=>(0,A.jsx)(W.Z,{value:e,children:e},l)))})]}),(0,A.jsxs)(R.Z,{fullWidth:!0,children:[(0,A.jsx)(P.Z,{id:"select-label",children:"Select Client Type"}),(0,A.jsxs)(O.Z,{name:"client_type",id:"client_type",label:"Select Client Type",labelId:"clientLabel",className:"selectfield",value:m.values.client_type,onChange:m.handleChange,style:{...s},children:[(0,A.jsx)(W.Z,{value:"Client",selected:!0,children:"Client"}),(0,A.jsx)(W.Z,{value:"Vendor",children:"Vendor"}),(0,A.jsx)(W.Z,{value:"admin",children:"Admin"})]})]})]}),(0,A.jsxs)(F.ZP,{item:!0,xs:6,children:[(0,A.jsx)(S.Z,{variant:"h6",children:"Financial Information"}),(0,A.jsx)("p",{}),(0,A.jsx)(B.gN,{as:q.Z,style:{...s},name:"fin_contact_name",label:"Financial Contact Name",fullWidth:!0,onChange:e=>{var l;return null===m||void 0===m?void 0:m.setFieldValue("fin_contact_name",(0,C.Ao)(null===e||void 0===e||null===(l=e.target)||void 0===l?void 0:l.value))},value:m.values.fin_contact_name,error:m.touched.fin_contact_name&&Boolean(m.errors.fin_contact_name),helperText:m.touched.fin_contact_name&&m.errors.fin_contact_name}),(0,A.jsx)(B.gN,{as:q.Z,style:{...s},name:"fin_email",label:"Financial Email",fullWidth:!0,onChange:m.handleChange,value:m.values.fin_email,error:m.touched.fin_email&&Boolean(m.errors.fin_email),helperText:m.touched.fin_email&&m.errors.fin_email}),(0,A.jsx)(B.gN,{as:q.Z,style:{...s},name:"fin_phone",label:"Financial Phone",fullWidth:!0,onChange:m.handleChange,value:m.values.fin_phone,error:m.touched.fin_phone&&Boolean(m.errors.fin_phone),helperText:m.touched.fin_phone&&m.errors.fin_phone}),(0,A.jsxs)(R.Z,{fullWidth:!0,children:[(0,A.jsx)(P.Z,{id:"select-label",children:"Parent Client"}),(0,A.jsxs)(O.Z,{id:"parent_client",name:"parent_client",style:{...s},fontSize:"sm",fullWidth:!0,label:"Parent Client",width:"250px",variant:"outlined",onChange:m.handleChange,value:m.values.parent_client||"",error:m.touched.parent_client&&Boolean(m.errors.parent_client),children:[(0,A.jsx)(W.Z,{value:"",children:"Select Parent"}),t.map(((e,l)=>(0,A.jsx)(W.Z,{value:e.id,children:e.client_name},l)))]})]}),(0,A.jsxs)(R.Z,{fullWidth:!0,children:[(0,A.jsx)(P.Z,{id:"select-label",children:"Select Currency"}),(0,A.jsxs)(O.Z,{name:"currency",id:"currency",label:"Select Currency",labelId:"currencyLabel",className:"selectfield",value:m.values.currency,onChange:m.handleChange,style:{...s},children:[(0,A.jsx)(W.Z,{value:"INR",children:"INR"}),(0,A.jsx)(W.Z,{value:"USD",children:"USD"}),(0,A.jsx)(W.Z,{value:"GBP",children:"GBP"}),(0,A.jsx)(W.Z,{value:"AED",children:"AED"}),(0,A.jsx)(W.Z,{value:"EUR",children:"EUR"}),(0,A.jsx)(W.Z,{value:"SGD",children:"SGD"})]})]}),(0,A.jsx)(u.Z,{sx:{display:"flex",flexDirection:"column"},children:(0,A.jsx)(d.Z,{control:(0,A.jsx)(p.Z,{color:"primary",defaultChecked:m.values.active||!0}),label:"Active",name:"active",onChange:m.handleChange})})]})]}),(0,A.jsxs)(F.ZP,{style:{display:"flex",justifyContent:"flex-end",gap:"0.78rem"},children:[(0,A.jsx)(h.Z,{onClick:()=>a(),color:"primary",variant:"contained",children:"Cancel"}),(0,A.jsx)(h.Z,{type:"submit",color:"primary",variant:"contained",children:"Submit"})]})]})})};var U=t(57621),M=t(39504),V=t(13034);const H=function(e){let{id:l,termsrows:t,handleClose:a}=e;const[n,i]=(0,g.useState)([]),[r,o]=(0,g.useState)([]);let s=[];function c(e){try{if(Array.isArray(r)){let l=r.find((l=>l.id==e));return!!l&&l.term_value}return!1}catch(l){console.error("Error updating record :",l)}}return(0,g.useEffect)((()=>{try{let e="";Array.isArray(t)&&(e=t.find((e=>e.id===l))),e&&o(e.terms),s=y.Z.ListUserTerms("client"),s.then((e=>{let l=JSON.parse(e.data.data);i(l)}))}catch(e){console.error("Error fetching data:",e)}}),[]),(0,g.useEffect)((()=>{const e=(0,_.find)(t,{id:l});if(null!==e&&void 0!==e&&e.terms){const l=null===JSON||void 0===JSON?void 0:JSON.parse(null===e||void 0===e?void 0:e.terms);o(l)}}),[]),(0,A.jsxs)(u.Z,{sx:{display:"flex",flexDirection:"column",gap:"1rem",width:"100%","& .actions":{color:"text.secondary"},"& .textPrimary":{color:"text.primary",fontSize:"10px"},"& .MuiDataGrid-cellContent":{color:"text.primary",fontSize:"10px"},"& .MuiDataGrid-columnHeaderTitle":{color:"text.primary",fontSize:"10px",fontWeight:"bold"},"& .MuiDataGrid-columnHeaders":{bgcolor:"#a8d6f8"}},children:[(0,A.jsx)("h2",{children:"Manage Client Terms"}),(0,A.jsx)(F.ZP,{item:!0,xs:12,children:(0,A.jsx)(U.Z,{children:(0,A.jsx)(M.Z,{style:{background:"#fcfbfb"},children:n.map((e=>(0,A.jsxs)(u.Z,{display:"flex",justifyContent:"space-between",alignItems:"center",children:["".concat(e.term_text," (").concat(e.term_type,") - ").concat(e.term_value),"boolean"===e.term_type?(0,A.jsx)(d.Z,{control:(0,A.jsx)(V.Z,{checked:c(e.id),onChange:l=>((e,l)=>{if(e.target.checked)if(Array.isArray(r)){let t=r.filter((e=>e.id===(null===l||void 0===l?void 0:l.id)));t.length?t.term_value=e.target.checked:o((t=>[...t,{...l,term_value:e.target.checked}]))}else r&&!(0,_.isEmpty)(r)?o((t=>[...t,{...l,term_value:e.target.checked}])):o([{...l,term_value:e.target.checked}]);else o((e=>e.filter((e=>e.id!==(null===l||void 0===l?void 0:l.id)))))})(l,e)}),label:"Yes"}):(0,A.jsx)(q.Z,{label:"Term Value",name:"term_value",defaultValue:c(e.term_name)||e.term_value,onChange:l=>((e,l)=>{try{if(e.target.value)if(Array.isArray(r)){let t=r.filter((e=>e.term_name===l));t.length?t.term_value=e.target.value:o((t=>[...t,{term_name:l,term_value:e.target.value}]))}else o((t=>[...t,{term_name:l,term_value:e.target.value}]));else o((e=>Array.isArray(e)?e.filter((e=>e.term_name!==l)):e))}catch(t){console.error("Error updating record :",t)}})(l,e.term_name),margin:"normal"})]},e.id)))})})}),(0,A.jsxs)(F.ZP,{style:{display:"flex",justifyContent:"flex-end",gap:"0.78rem"},children:[(0,A.jsx)(h.Z,{onClick:()=>a(),color:"primary",variant:"contained",children:"Cancel"}),(0,A.jsx)(h.Z,{onClick:()=>{let e={table_name:"clients",field_to_update:"terms",new_value:JSON.stringify(r),table_id:l};try{let l=y.Z.UpdateData(e);null===l||void 0===l||l.then((e=>{200===e.status&&((0,C.OD)("Client terms updated successfully"),a())}))}catch(t){console.error("Error updating record :",t)}},variant:"contained",children:"Update Terms"})]})]})};function L(){var e,l,t;const Z=(0,j.s0)(),[b,S]=(0,g.useState)(!1),[D,k]=(0,g.useState)([]),[w,N]=(0,g.useState)(!1),[E,I]=(0,g.useState)([]),[F,q]=(0,g.useState)("client"),[R,P]=(0,g.useState)(0),O=(0,r.Z)(),W=(0,o.Z)(O.breakpoints.down("sm")),B=()=>{P(0),S(!1)},G=JSON.parse(null===(e=localStorage)||void 0===e?void 0:e.getItem("user")),z=async()=>{try{N(!0);const e=await y.Z.ListClients(),l=null===JSON||void 0===JSON?void 0:JSON.parse(e.data.data);I(l);const t=Object.keys(l[0]).map((e=>"active"===e?{field:e,flex:1,headerName:e.replaceAll("_"," ").toUpperCase(),renderCell:e=>(0,A.jsx)(d.Z,{control:(0,A.jsx)(p.Z,{color:"primary",defaultChecked:e.value}),size:"small",onChange:l=>U(l,e.id)},e.id)}:["id","fin_contact_name","fin_email","fin_phone","terms","candidateAuthForm","currency"].includes(e)?null:{field:e,flex:1,headerName:e.replaceAll("_"," ").toUpperCase(),editable:!0})).filter(Boolean);!(0,_.includes)(C._8,null===G||void 0===G?void 0:G.role)&&t.push({field:"actions",type:"actions",headerName:"ACTIONS",width:135,cellClassName:"actions",getActions:e=>[(0,A.jsx)(s.Z,{title:"Edit",arrow:!0,children:(0,A.jsx)(x.u,{color:"inherit",icon:(0,A.jsx)(n.Z,{color:"primary"}),label:"Edit",className:"textPrimary",onClick:M(e.id,"client")})}),(0,A.jsx)(s.Z,{title:"Billing Identifier",arrow:!0,children:(0,A.jsx)(x.u,{color:"inherit",icon:(0,A.jsx)(i.Z,{color:"primary"}),label:"Acknowledge",className:"textPrimary",onClick:()=>Z("/billingList/".concat(e.id))})})]}),k(t)}catch(e){console.error("Error fetching data:",e)}finally{N(!1)}};(0,g.useEffect)((()=>{z()}),[]);const U=(e,l)=>{let t={table_name:"clients",field_to_update:"active",new_value:e.target.checked,table_id:l};try{y.Z.UpdateData(t)}catch(a){console.error("Error updating record :",a)}},M=(e,l)=>()=>{P(e),q(l),S(!0)};return(0,A.jsxs)(u.Z,{sx:{width:"100%",display:"flex",flexDirection:"column",gap:.5,"& .actions":{color:"text.secondary"},"& .textPrimary":{color:"text.primary",fontSize:"10px"},"& .MuiDataGrid-cellContent":{color:"text.primary",fontSize:"10px"},"& .MuiDataGrid-columnHeaderTitle":{color:"#fff",fontSize:"10px",fontWeight:"bold"},"& .MuiDataGrid-columnHeader":{bgcolor:"#2152a1"},"& .MuiDataGrid-row":{"&:nth-of-type(even)":{backgroundColor:"#DDE1E9"}},"& .MuiDataGrid-columnHeaderTitleContainer":{justifyContent:"flex-start"},"& .MuiDataGrid-cell--textLeft":{justifyContent:"left !important"}},children:[!(0,_.includes)(C._8,null===G||void 0===G?void 0:G.role)&&(0,A.jsx)("table",{width:"100%",children:(0,A.jsx)("tbody",{children:(0,A.jsx)("tr",{children:(0,A.jsx)("td",{width:"100%",align:"left",children:(0,A.jsx)(h.Z,{color:"primary",startIcon:(0,A.jsx)(a.Z,{}),onClick:()=>S(!0),variant:"contained",style:{float:"right"},children:"Add Client"})})})})}),w?(0,A.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,A.jsx)(c.Z,{color:"inherit",size:20})}):(0,A.jsx)(v._$,{rows:(0,_.includes)(C._8,null===G||void 0===G?void 0:G.role)?(0,_.filter)(E,(e=>(null===e||void 0===e?void 0:e.id)===(null===G||void 0===G?void 0:G.client_id))):E,rowHeight:38,columns:D,disableRowSelectionOnClick:!0,slots:{toolbar:f.n},getRowClassName:e=>e.indexRelativeToCurrentPage%2===0?"even":"odd"}),(0,A.jsx)(m.Z,{open:b,onClose:B,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,A.jsxs)(u.Z,{sx:{position:"absolute",overflowY:"auto",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:W?"90%":"client"===F?"680px":null===O||void 0===O||null===(l=O.breakpoints)||void 0===l||null===(t=l.values)||void 0===t?void 0:t.sm,maxWidth:"90%",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4,"& label":{lineHeight:"2em !important"}},children:["client"===F&&(0,A.jsx)(J,{id:R,clients:E,handleClose:B,fetchData:z}),"terms"===F&&(0,A.jsx)(H,{id:R,termsrows:E,handleClose:B}),"acknowledge"===F&&(0,A.jsx)(T,{id:R,handleClose:B,rows:E})]})})]})}}}]);
//# sourceMappingURL=215.6e39b608.chunk.js.map